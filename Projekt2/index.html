<html>
    <head>
        <title>Webpage zur Datenbank Befragung</title>
        <meta charset="utf-8"/>
        <link rel="stylesheet" type="text/css" href="style.css">
    </head>
<BODY>
    <div>
       <h2>Projekt-Suche</h2> 
       <form>
        <label for="Project">Projektname:</label>
        <input type="text" name="project" id="project" placeholder="Projektname eingeben" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; margin-bottom: 10px;"><br>
        <button type="button" id="button1" onclick="callService(document.getElementById('project').value)">Suchen</button>
       </form>
    </div>
    
    

    <SCRIPT>
        
        function callService() {
            var string = document.getElementById('project').value;
            var request = new XMLHttpRequest();
            var url = "http://localhost:8080/?project=" + string;
            request.open("GET", url, true);
            request.onreadystatechange = function () {
                var table;
                if (request.readyState == request.DONE && request.status == 200) {
                    try{    
                        var data = JSON.parse(request.responseText);
                        table = "<TABLE>";
                        table += "<tr><th>ProjectID</th><th>Project Name</th><th>Start Date</th><th>End Date</th></tr>";    
                        for (var row in data) {
                            table += ("<TR>");
                            var colCount = 0;
                            for (var field in data[row]) {
                                if (field == "StartDate" || field == "EndDate") {
                                    var date = data[row][field];
                                    var dateStringShort = date.substring(0,10);
                                    table += ("<TD>" + dateStringShort + "</TD>");
                                } else {
                                    table += ("<TD>" + data[row][field] + "</TD>");
                                }
                                colCount++;
                                if (colCount == 4) { // limit to 4 columns
                                    break;
                                }
                            }
                            table += ("</TR>");
                        }
                        table += "</TABLE>";

                        // Create the popup window and add the table to it
                        var popup = document.createElement('div2');
                        popup.classList.add('popup');
                        popup.innerHTML = '<span class="close" onclick="this.parentNode.parentNode.removeChild(this.parentNode);">&times;</span>' + table;
                        document.body.appendChild(popup);
                    } catch(e){
                        console.error(e);
                    }
                }
            }
            request.send(null);
        }
    </SCRIPT>
</BODY>

</html>