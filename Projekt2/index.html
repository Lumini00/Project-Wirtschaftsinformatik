<html>
    <head>
        <title>Webpage zur Datenbank Befragung</title>
        <meta charset="utf-8"/>
        <link rel="stylesheet" type="text/css" href="style.css">
    </head>
<BODY>
    <div>
       <h2>Projekt-Suche</h2> 
       <form>
        <label for="Project">Projektname:</label>
        <input type="text" name="project" id="project" placeholder="Projektname eingeben" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; margin-bottom: 10px;"><br>
        <button type="submit" onclick="queryProject(document.getElementById('project').value)">Suchen</button>
       </form>
       <div id="projectoutput"></div> 

    </div>

    <div>
        <h2>Projekte und Mitarbeiter nach Stadt</h2>
        <form>
            <label for="city">Stadt:</label>
            <select id="city" name="city" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; margin-bottom: 10px;">
                <option value="Zurich">ZÃ¼rich</option>
                <option value="Bern">Bern</option>
                <option value="Basel">Basel</option>
                <option value="Lucerne">Luzern</option>
                <option value="Geneva">Genf</option>
                <option value="Lausanne">Lausanne</option>
            </select><br>
            <button type="submit" onclick="queryCity(document.getElementById('city').value)" >Suchen</button>
        </form>
        <div id="cityoutput"></div> 
    </div>
    
    <div>
        <h2>Projekte in Kostenbereich zwischen Kosten1 und Kosten2 </h2>
        <form>
            <label for="minCost">Minimale Kosten:</label>
            <input type="number" id="minCost" name="minCost" placeholder="Minimale Kosten eingeben" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; margin-bottom: 10px;"><br>
            <label for="maxCost">Maximale Kosten:</label>
            <input type="number" id="maxCost" name="maxCost" placeholder="Maximale Kosten eingeben" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; margin-bottom: 10px;"><br>
            <button type="submit" onclick="queryCost(document.getElementById('minCost').value, document.getElementById('maxCost').value)">Suchen</button>
        </form>
        <div id="costoutput"></div> 
    </div>
    

    <SCRIPT>
        var url; 
        var table;
        
        function queryProject() {
            var string = document.getElementById('project').value;
            var request = new XMLHttpRequest();
            url = "http://localhost:8080/?project=" + string;
            request.open("GET", url, true);
            

            request.onreadystatechange = function () {
                if (request.readyState == request.DONE && request.status == 200) {
                    try{    
                        var data = JSON.parse(request.responseText);
                        table = "<TABLE>";
                        table += "<tr><th>ProjectID</th><th>Project Name</th><th>Start Date</th><th>End Date</th></tr>";    
                        for (var row in data) {
                            table += ("<TR>");
                            var colCount = 0;
                            for (var field in data[row]) {
                                if (field == "StartDate" || field == "EndDate") {
                                    var date = data[row][field];
                                    var dateStringShort = date.substring(0,10);
                                    table += ("<TD>" + dateStringShort + "</TD>");
                                } else {
                                    table += ("<TD>" + data[row][field] + "</TD>");
                                }
                                colCount++;
                                if (colCount == 4) { // limit to 4 columns
                                    break;
                                }
                            }
                            table += ("</TR>");
                        }
                        table += "</TABLE>";
                        projectoutput.innerHTML = table;
                        
                    } catch(e){
                        console.error(e);
                    }
                }
            }
            request.send(null);
        }

        function queryCity(){
            var string = document.getElementById('city').value;
            var request = new XMLHttpRequest();
            var url = "http://localhost:8080/?city=" + string;
            request.open("GET", url, true);
            request.onreadystatechange = function () {
                var table;
                if (request.readyState == request.DONE && request.status == 200) {
                    try{    
                        var data = JSON.parse(request.responseText);
                        table = "<TABLE>";
                        table += "<tr><th>FirstName</th><th>LastName</th><th>ProjectName</th><th>CityName</th></tr>";    
                        for (var row in data) {
                            table += ("<TR>");
                            var colCount = 0;
                            for (var field in data[row]) {
                                table += ("<TD>" + data[row][field] + "</TD>");
                            
                                colCount++;
                                    if (colCount == 4) { // limit to 4 columns
                                        break;
                                    }
                            }
                            table += ("</TR>");
                        }
                        table += "</TABLE>";
                        cityoutput.innerHTML = table;
                        
                    } catch(e){
                        console.error(e);
                    }
                }
            }
            request.send(null);
        }

        function queryCost(){
            var string1 = document.getElementById('minCost').value;
            var string2 = document.getElementById('maxCost').value;
            var request = new XMLHttpRequest();
            var url = "http://localhost:8080/?minCost=" + string1 + "&maxCost=" + string2;
            request.open("GET", url, true);
            request.onreadystatechange = function () {
                var table;
                if (request.readyState == request.DONE && request.status == 200) {
                    try{    
                        var data = JSON.parse(request.responseText);
                        table = "<TABLE>";
                        table += "<tr><th>ProjectID</th><th>ProjectName</th><th>MaximumCosts</th></tr>";    
                        for (var row in data) {
                            table += ("<TR>");
                            var colCount = 0;
                            for (var field in data[row]) {
                                table += ("<TD>" + data[row][field] + "</TD>");
                            
                                colCount++;
                                    if (colCount == 3) { // limit to 3 columns
                                        break;
                                    }
                            }
                            table += ("</TR>");
                        }
                        table += "</TABLE>";
                        costoutput.innerHTML = table;
                        
                    } catch(e){
                        console.error(e);
                    }
                }
            }
            request.send(null);
        }
    </SCRIPT>
</BODY>

</html>